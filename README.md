
# Система управления заказами в кафе

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![Django](https://img.shields.io/badge/Django-4+-green.svg)
![Лицензия](https://img.shields.io/badge/Лицензия-MIT-yellow.svg)

Полнофункциональное веб-приложение на Django для управления заказами в кафе. Позволяет добавлять, просматривать, изменять и удалять заказы через веб-интерфейс, а также предоставляет REST API для программного взаимодействия. Включает управление заказами, расчет выручки и полное тестирование.

## Возможности

- **Управление заказами**: Добавление, редактирование, удаление и просмотр заказов с автоматическим расчетом общей стоимости.
- **Поиск и фильтрация**: Поиск заказов по номеру стола или статусу.
- **Расчет выручки**: Подсчет общей суммы выручки за оплаченные заказы за заданный период.
- **REST API**: Полный набор CRUD-операций для заказов и отчет о выручке через API.
- **Обработка ошибок**: Надежная валидация и сообщения об ошибках при некорректных данных.
- **Тестирование**: Полный набор тестов для моделей, форм, представлений и API с использованием Pytest.

## Технологический стек

- **Python**: 3.8+
- **Django**: 4+
- **База данных**: SQLite (по умолчанию, настраивается для PostgreSQL)
- **Django REST Framework**: Для REST API
- **HTML/CSS**: Базовые шаблоны для фронтенда
- **Pytest**: Для автоматического тестирования

## Требования

Перед началом убедитесь, что у вас установлены:
- Python 3.8 или выше
- Git
- (Опционально) Virtualenv для изолированных окружений

## Установка

Следуйте этим шагам для запуска проекта локально:

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/yourusername/cafe_management.git
   cd cafe_management
   ```

2. **Создайте виртуальное окружение**:
   ```bash
   python -m venv venv
   source venv/bin/activate  # Для Windows: venv\Scripts\activate
   ```

3. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Примените миграции базы данных**:
   ```bash
   python manage.py migrate
   ```

5. **Создайте файл `dishes.json`**:
   - Создайте директорию `static/orders/` в корне проекта.
   - Добавьте файл `dishes.json` с примерами блюд:
     ```json
     [
         {"id": 1, "name": "Пицца", "price": 15.00},
         {"id": 2, "name": "Кофе", "price": 10.50}
     ]
     ```

6. **Запустите сервер разработки**:
   ```bash
   python manage.py runserver
   ```

7. **Доступ к приложению**:
   - Веб-интерфейс: `http://localhost:8000/orders/`
   - API: `http://localhost:8000/orders/api/orders/`

## Использование

### Веб-интерфейс
- **Просмотр заказов**: Перейдите на `/orders/` для просмотра всех заказов.
- **Добавление заказа**: Используйте `/orders/create/` для создания нового заказа.
- **Редактирование заказа**: Перейдите на `/orders/update/<order_id>/` для изменения заказа.
- **Удаление заказа**: Откройте `/orders/delete/<order_id>/` для удаления заказа.
- **Отчет о выручке**: Проверьте `/orders/revenue/` для расчета выручки оплаченных заказов.

### REST API
- **Список заказов**: `GET /orders/api/orders/`
- **Создание заказа**: `POST /orders/api/orders/` (требуется токен аутентификации)
- **Обновление заказа**: `PUT /orders/api/orders/<id>/`
- **Удаление заказа**: `DELETE /orders/api/orders/<id>/`
- **Отчет о выручке**: `GET /orders/api/orders/revenue/?start_date=ГГГГ-ММ-ДД&end_date=ГГГГ-ММ-ДД`

Пример запроса к API (создание заказа):
```bash
curl -X POST http://localhost:8000/orders/api/orders/ \
-H "Authorization: Token <ваш_токен>" \
-H "Content-Type: application/json" \
-d '{"table_number": 1, "dishes": [1, 2], "status": "waiting"}'
```

## Структура проекта

```
cafe_management/
├── cafe_management/  # Настройки проекта и основные URL
├── orders/          # Основное приложение
│   ├── migrations/  # Миграции базы данных
│   ├── tests/       # Тесты на Pytest
│   ├── admin.py     # Настройки администратора
│   ├── api_views.py # Представления для REST API
│   ├── apps.py      # Настройка приложения Заказов
│   ├── forms.py     # Форма для заказов
│   ├── models.py    # Модели Order и Dish
│   ├── urls.py      # Маршруты приложения
│   ├── serializers.py # Сериализаторы приложения
│   └── views.py     # Веб-представления
├── static/          # Статические файлы (например, dishes.json)
├── templates/       # HTML шаблоны
└── requirements.txt # Зависимости проекта
```

## Тестирование

Проект включает полный набор тестов для проверки функциональности.

1. **Запуск тестов**:
   ```bash
   pytest -v
   ```

2. **Покрытие тестами**: 100% ключевого функционала (21 успешных тестов).

## Замечания по разработке

- **База данных**: По умолчанию настроена на SQLite. Для использования PostgreSQL обновите настройки в `settings.py`.
- **Аутентификация**: API требует токен-аутентификацию. Создайте суперпользователя и токен:
  ```bash
  python manage.py createsuperuser
  python manage.py drf_create_token <имя_пользователя>
  ```

## Вклад в проект

Приветствуются форки, сообщения об ошибках и пул-реквесты!

## Лицензия

Проект распространяется под лицензией MIT.
```
